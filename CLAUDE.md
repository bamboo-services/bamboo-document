# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

This is a **Fumadocs documentation site** built with Next.js 16, React 19, TypeScript 5, and Tailwind CSS 4. It's a Chinese-language documentation website (竹简文档 - Bamboo Documents) with custom sidebar implementation and AI integration features.

## Common Commands

```bash
# Development
pnpm dev              # Start development server on http://localhost:3000

# Build & Type Check
pnpm build            # Build for production
pnpm types:check      # Run type checking (fumadocs-mdx + next typegen + tsc)

# Linting
pnpm lint             # Run ESLint
```

## Architecture

### Content Layer (Fumadocs MDX)

- **Content location**: `content/docs/` - MDX files for documentation
- **Content source**: `src/lib/source.ts` - Uses Fumadocs `loader()` to process MDX files
- **Configuration**: `source.config.ts` - Defines docs collection with Zod schema validation
- **Generated files**: `.source/` - Auto-generated by Fumadocs (do not edit manually)

The content source uses a special path alias `fumadocs-mdx:collections/server` to access generated collections.

### Custom Sidebar Implementation

This project has a **custom sidebar** that extends Fumadocs UI:

- **Core logic**: `src/components/layout/sidebar/base.tsx`
  - `SidebarProvider` / `useSidebar()` - Context for sidebar state
  - `SidebarFolder` / `useFolder()` - Collapsible folder components with depth tracking
  - Supports two modes: `drawer` (mobile) and `full` (desktop)
  - Hover-to-expand when collapsed on desktop

- **Page tree rendering**: `src/components/layout/sidebar/page-tree.tsx`
  - Renders navigation from Fumadocs page tree structure
  - Supports separators and external links

### Layout Structure

- **Shared options**: `src/lib/layout.shared.tsx` - Base layout configuration (nav title, etc.)
- **Home layout**: `src/app/(home)/` - Landing page route group
- **Docs layout**: `src/app/docs/` - Documentation pages with custom sidebar
- **Root provider**: Uses `RootProvider` from `fumadocs-ui` for theming and search

### MDX Components

- **Configuration**: `src/mdx-components.tsx` - Exports `getMDXComponents()` to customize MDX rendering
- Custom components can be added here for use in MDX files

### AI Integration Features

The site includes AI-friendly features:

- **Page actions**: `src/components/ai/page-actions.tsx`
  - `LLMCopyButton` - Copies raw MDX content
  - `ViewOptions` - Opens docs in external AI platforms (ChatGPT, Claude, etc.)

- **LLM routes**:
  - `/llms.txt` - Lists all documentation pages
  - `/llms-full.txt` - Full documentation content
  - `/docs/*.mdx` - Raw MDX content (rewritten to `/llms.mdx/docs/*`)

### Search

- **Search engine**: Orama via `fumadocs-core/search/server`
- **API endpoint**: `src/app/api/search/route.ts`
- **UI**: Search toggle with keyboard shortcuts (Ctrl+K / Cmd+K)

### Styling Conventions

- **Tailwind CSS v4** with `@import` syntax in `src/app/global.css`
- **Fumadocs CSS variables**: Uses `fd-` prefix (e.g., `--fd-primary`, `--fd-card`)
- **Component variants**: Uses `class-variance-authority` (CVA)
- **Utility**: `cn()` from `tailwind-merge` for class merging

### Key Dependencies

- `fumadocs-core`, `fumadocs-ui`, `fumadocs-mdx` - Documentation framework
- `@radix-ui/*` - Headless UI primitives
- `next-themes` - Theme management
- `lucide-react` - Icons

### TypeScript Configuration

- Path alias: `@/*` maps to `./src/*`
- Special alias: `fumadocs-mdx:collections/*` for generated collections
- Strict mode enabled
